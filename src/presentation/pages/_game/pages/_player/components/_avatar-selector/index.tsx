import { faker } from '@faker-js/faker';
import { FC, Fragment, useEffect, useRef } from 'react';

import { Popover, Ripple } from '@presentation/components';
import { useStates } from '@presentation/hooks';

import {
  AvatarOption,
  Container,
  PopoverContent,
  PopoverSection,
  PopoverSectionTitle,
} from './styles';

import { AvatarSelectorProps } from './types';

const avatars = {
  'ğŸ–ï¸': [
    ...['ğŸ‘¶', 'ğŸ§’', 'ğŸ‘§', 'ğŸ‘¦', 'ğŸ§‘', 'ğŸ‘©', 'ğŸ‘¨', 'ğŸ§‘â€ğŸ¦±', 'ğŸ‘©â€ğŸ¦±', 'ğŸ‘¨â€ğŸ¦±'],
    ...['ğŸ§‘â€ğŸ¦°', 'ğŸ‘©â€ğŸ¦°', 'ğŸ‘¨â€ğŸ¦°', 'ğŸ‘±', 'ğŸ‘±â€â™€ï¸', 'ğŸ‘±â€â™‚ï¸', 'ğŸ§‘â€ğŸ¦³', 'ğŸ‘©â€ğŸ¦³', 'ğŸ‘¨â€ğŸ¦³', 'ğŸ§‘â€ğŸ¦²'],
    ...['ğŸ‘©â€ğŸ¦²', 'ğŸ‘¨â€ğŸ¦²', 'ğŸ§”', 'ğŸ§”â€â™€ï¸', 'ğŸ§”â€â™‚ï¸', 'ğŸ§“', 'ğŸ‘µ', 'ğŸ‘´'],
  ],
  'ğŸ–ğŸ»': [
    ...['ğŸ‘¶ğŸ»', 'ğŸ§’ğŸ»', 'ğŸ‘§ğŸ»', 'ğŸ‘¦ğŸ»', 'ğŸ§‘ğŸ»', 'ğŸ‘©ğŸ»', 'ğŸ‘¨ğŸ»', 'ğŸ§‘ğŸ»â€ğŸ¦±', 'ğŸ‘©ğŸ»â€ğŸ¦±', 'ğŸ‘¨ğŸ»â€ğŸ¦±'],
    ...['ğŸ§‘ğŸ»â€ğŸ¦°', 'ğŸ‘©ğŸ»â€ğŸ¦°', 'ğŸ‘¨ğŸ»â€ğŸ¦°', 'ğŸ‘±ğŸ»', 'ğŸ‘±ğŸ»â€â™€ï¸', 'ğŸ‘±ğŸ»â€â™‚ï¸', 'ğŸ§‘ğŸ»â€ğŸ¦³', 'ğŸ‘©ğŸ»â€ğŸ¦³', 'ğŸ‘¨ğŸ»â€ğŸ¦³', 'ğŸ§‘ğŸ»â€ğŸ¦²'],
    ...['ğŸ‘©ğŸ»â€ğŸ¦²', 'ğŸ‘¨ğŸ»â€ğŸ¦²', 'ğŸ§”ğŸ»', 'ğŸ§”ğŸ»â€â™€ï¸', 'ğŸ§”ğŸ»â€â™‚ï¸', 'ğŸ§“ğŸ»', 'ğŸ‘µğŸ»', 'ğŸ‘´ğŸ»'],
  ],
  'ğŸ–ğŸ¼': [
    ...['ğŸ‘¶ğŸ¼', 'ğŸ§’ğŸ¼', 'ğŸ‘§ğŸ¼', 'ğŸ‘¦ğŸ¼', 'ğŸ§‘ğŸ¼', 'ğŸ‘©ğŸ¼', 'ğŸ‘¨ğŸ¼', 'ğŸ§‘ğŸ¼â€ğŸ¦±', 'ğŸ‘©ğŸ¼â€ğŸ¦±', 'ğŸ‘¨ğŸ¼â€ğŸ¦±'],
    ...['ğŸ§‘ğŸ¼â€ğŸ¦°', 'ğŸ‘©ğŸ¼â€ğŸ¦°', 'ğŸ‘¨ğŸ¼â€ğŸ¦°', 'ğŸ‘±ğŸ¼', 'ğŸ‘±ğŸ¼â€â™€ï¸', 'ğŸ‘±ğŸ¼â€â™‚ï¸', 'ğŸ§‘ğŸ¼â€ğŸ¦³', 'ğŸ‘©ğŸ¼â€ğŸ¦³', 'ğŸ‘¨ğŸ¼â€ğŸ¦³', 'ğŸ§‘ğŸ¼â€ğŸ¦²'],
    ...['ğŸ‘©ğŸ¼â€ğŸ¦²', 'ğŸ‘¨ğŸ¼â€ğŸ¦²', 'ğŸ§”ğŸ¼', 'ğŸ§”ğŸ¼â€â™€ï¸', 'ğŸ§”ğŸ¼â€â™‚ï¸', 'ğŸ§“ğŸ¼', 'ğŸ‘µğŸ¼', 'ğŸ‘´ğŸ¼'],
  ],
  'ğŸ–ğŸ½': [
    ...['ğŸ‘¶ğŸ½', 'ğŸ§’ğŸ½', 'ğŸ‘§ğŸ½', 'ğŸ‘¦ğŸ½', 'ğŸ§‘ğŸ½', 'ğŸ‘©ğŸ½', 'ğŸ‘¨ğŸ½', 'ğŸ§‘ğŸ½â€ğŸ¦±', 'ğŸ‘©ğŸ½â€ğŸ¦±', 'ğŸ‘¨ğŸ½â€ğŸ¦±'],
    ...['ğŸ§‘ğŸ½â€ğŸ¦°', 'ğŸ‘©ğŸ½â€ğŸ¦°', 'ğŸ‘¨ğŸ½â€ğŸ¦°', 'ğŸ‘±ğŸ½', 'ğŸ‘±ğŸ½â€â™€ï¸', 'ğŸ‘±ğŸ½â€â™‚ï¸', 'ğŸ§‘ğŸ½â€ğŸ¦³', 'ğŸ‘©ğŸ½â€ğŸ¦³', 'ğŸ‘¨ğŸ½â€ğŸ¦³', 'ğŸ§‘ğŸ½â€ğŸ¦²'],
    ...['ğŸ‘©ğŸ½â€ğŸ¦²', 'ğŸ‘¨ğŸ½â€ğŸ¦²', 'ğŸ§”ğŸ½', 'ğŸ§”ğŸ½â€â™€ï¸', 'ğŸ§”ğŸ½â€â™‚ï¸', 'ğŸ§“ğŸ½', 'ğŸ‘µğŸ½', 'ğŸ‘´ğŸ½'],
  ],
  'ğŸ–ğŸ¾': [
    ...['ğŸ‘¶ğŸ¾', 'ğŸ§’ğŸ¾', 'ğŸ‘§ğŸ¾', 'ğŸ‘¦ğŸ¾', 'ğŸ§‘ğŸ¾', 'ğŸ‘©ğŸ¾', 'ğŸ‘¨ğŸ¾', 'ğŸ§‘ğŸ¾â€ğŸ¦±', 'ğŸ‘©ğŸ¾â€ğŸ¦±', 'ğŸ‘¨ğŸ¾â€ğŸ¦±'],
    ...['ğŸ§‘ğŸ¾â€ğŸ¦°', 'ğŸ‘©ğŸ¾â€ğŸ¦°', 'ğŸ‘¨ğŸ¾â€ğŸ¦°', 'ğŸ‘±ğŸ¾', 'ğŸ‘±ğŸ¾â€â™€ï¸', 'ğŸ‘±ğŸ¾â€â™‚ï¸', 'ğŸ§‘ğŸ¾â€ğŸ¦³', 'ğŸ‘©ğŸ¾â€ğŸ¦³', 'ğŸ‘¨ğŸ¾â€ğŸ¦³', 'ğŸ§‘ğŸ¾â€ğŸ¦²'],
    ...['ğŸ‘©ğŸ¾â€ğŸ¦²', 'ğŸ‘¨ğŸ¾â€ğŸ¦²', 'ğŸ§”ğŸ¾', 'ğŸ§”ğŸ¾â€â™€ï¸', 'ğŸ§”ğŸ¾â€â™‚ï¸', 'ğŸ§“ğŸ¾', 'ğŸ‘µğŸ¾', 'ğŸ‘´ğŸ¾'],
  ],
  'ğŸ–ğŸ¿': [
    ...['ğŸ‘¶ğŸ¿', 'ğŸ§’ğŸ¿', 'ğŸ‘§ğŸ¿', 'ğŸ‘¦ğŸ¿', 'ğŸ§‘ğŸ¿', 'ğŸ‘©ğŸ¿', 'ğŸ‘¨ğŸ¿', 'ğŸ§‘ğŸ¿â€ğŸ¦±', 'ğŸ‘©ğŸ¿â€ğŸ¦±', 'ğŸ‘¨ğŸ¿â€ğŸ¦±'],
    ...['ğŸ§‘ğŸ¿â€ğŸ¦°', 'ğŸ‘©ğŸ¿â€ğŸ¦°', 'ğŸ‘¨ğŸ¿â€ğŸ¦°', 'ğŸ‘±ğŸ¿', 'ğŸ‘±ğŸ¿â€â™€ï¸', 'ğŸ‘±ğŸ¿â€â™‚ï¸', 'ğŸ§‘ğŸ¿â€ğŸ¦³', 'ğŸ‘©ğŸ¿â€ğŸ¦³', 'ğŸ‘¨ğŸ¿â€ğŸ¦³', 'ğŸ§‘ğŸ¿â€ğŸ¦²'],
    ...['ğŸ‘©ğŸ¿â€ğŸ¦²', 'ğŸ‘¨ğŸ¿â€ğŸ¦²', 'ğŸ§”ğŸ¿', 'ğŸ§”ğŸ¿â€â™€ï¸', 'ğŸ§”ğŸ¿â€â™‚ï¸', 'ğŸ§“ğŸ¿', 'ğŸ‘µğŸ¿', 'ğŸ‘´ğŸ¿'],
  ],
};

export const AvatarSelector: FC<AvatarSelectorProps> = ({
  disabled,
  defaultValue,
  readOnly,
  onChange,
}) => {
  const [s, set] = useStates({
    opened: false,
    selected: faker.helpers.arrayElement(faker.helpers.objectValue(avatars)),
  });

  const ref = useRef<HTMLButtonElement>(null);

  useEffect(() => {
    if (!defaultValue) return;
    s.selected = defaultValue;
  }, [defaultValue]);

  useEffect(() => {
    if (s.selected) onChange?.(s.selected);
  }, [s.selected]);

  return (
    <>
      <Ripple ref={ref}>
        <Container
          className='AvatarSelector'
          icon={s.selected}
          $disabled={disabled}
          $readOnly={readOnly}
        />
      </Ripple>
      <Popover anchorRef={ref} onToggle={set('opened')}>
        <PopoverContent>
          {Object.entries(avatars).map(([key, avatars]) => (
            <Fragment key={key}>
              <PopoverSectionTitle>{key}</PopoverSectionTitle>

              <PopoverSection>
                {avatars.map((avatar) => (
                  <AvatarOption key={avatar} onClick={set('selected', avatar)}>
                    {avatar}
                  </AvatarOption>
                ))}
              </PopoverSection>
            </Fragment>
          ))}
        </PopoverContent>
      </Popover>
    </>
  );
};
